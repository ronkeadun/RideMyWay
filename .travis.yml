language: node_js

node_js:
  - "stable"

env:
  - NODE_ENV="development"


services:
  - postgresql

addons:
  postgresql: "10"
  apt:
    packages:
    - postgresql-10
    - postgresql-client-10
env:
  global:
  - process.env.DB_USER_TEST=ronke
  - process.env.DB_HOST_TEST=localhost
  - process.env.DB_NAME_TEST=ridesDB
  - process.env.DB_PASSWORD_TEST=3377
  - process.env.DB_PORT_TEST=5432

before_script:
  - psql -c 'drop database if exists ridesDB;' -U postgres
  - psql -c 'create database ridesDB;' -U postgres

script:
  - mocha --require babel-register

# safelist
branches:
  only:
  - master
  - gh-pages
